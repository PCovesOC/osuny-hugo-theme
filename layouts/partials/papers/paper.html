{{ $inside_volume := .inside_volume | default false }}
{{ $modalId := print "modalID_" .index }}

{{ with .paper }}
  <article class="paper" itemscope itemtype="https://schema.org/ScholarlyArticle" {{- if $inside_volume }} itemProp="hasPart" {{- end -}}>
    <div>
      <h3>
        <a href="{{ .Permalink }}" itemprop="url">
          <span itemprop="name">{{ partial "PrepareHTML" .Title }}</span>
        </a>
      </h3>
      {{- range $index, $authors := .Params.Researchers -}}
        {{- $author := site.GetPage (printf "/persons/%s" .) -}}
        {{- if ne $index 0 -}},{{ end }}
        <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="{{ $author.Permalink }}" itemprop="url"><span itemprop="name">{{ trim $author.Title "\n" }}</span></a></span>
      {{- end -}}
      <p class="paper-volume">
        <span>Article</span>
        {{ if not $inside_volume }}
          {{ range .Params.Volumes }}
            {{ $volume := site.GetPage (printf "/volumes/%s" .) }}
            {{ if $volume }}
              {{ i18n "commons.in" }} “<a href="{{ $volume.Permalink }}">{{ $volume.Title }}</a>”
            {{ end }}
          {{ end }}
        {{ end }}
      </p>
    </div>
    <div class="paper-actions" role="group">
      {{/*  <button class="squared-button" type="button" data-bs-toggle="modal" data-bs-target="#{{ $modalId }}">{{ i18n "volumes.abstract" }}</button>  */}}
      {{ if .Params.pdf }}
      {{- $pdf := partial "GetMedia" .Params.pdf -}}
      {{- $pdf_size := partial "GetHumanSize" $pdf.size -}}
      <a href="{{ $pdf.url }}" download>
        {{- i18n "commons.pdf_with_size" (dict "Size" $pdf_size) }}
      </a>
      {{ end }}
      <a class="squared-button" href="#" download>PDF (435 ko)</a>
    </div>
      {{ partial "papers/modal.html"
            (dict
              "modalId" $modalId
              "title" .Title
              "abstract" .Params.abstract
            ) }}
  </article>
{{ end }}