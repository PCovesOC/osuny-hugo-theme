{{- $template := .block.template -}}
{{- $position := .block.position -}}
{{- $title := .block.title -}}
{{- with .block.data -}}
  <section class="block block-partners{{ if $title }} block-with-title{{ end }}" id="block-{{ $position }}">
    <div class="container">
      <div class="block-content">
        {{ if (or $title .description) -}}
          <div class="top">
            {{- if not $title -}}
              {{ partial "blocks/default_title.html" $template }}
            {{ else }}
              <h2>{{ partial "PrepareHTML" $title }}</h2>
            {{ end -}}
            {{- if .description }}
              <div class="description">
                {{ partial "PrepareHTML" .description }}
              </div>
            {{ end -}}
          </div>
        {{- end }}

        <div class="organizations">
          {{- range .partners }}
            <div>
              {{- if .slug }}
                {{ with (site.GetPage (printf "/organizations/%s" .slug )) }}
                  {{- partial "organizations/organization.html" . -}}
                {{ end }}
              {{- else -}}
                <article class="organization">
                  {{- $title := "" -}}
                  {{ if .name }}
                    <div>
                      {{ $title = partial "PrepareHTML" .name -}}
                      <h3>
                        {{- if .url }}
                        <a href="{{ .url }}" title="{{ safeHTML (i18n "commons.link.blank_aria" (dict "Title" $title)) }}">
                        {{ end }}
                          {{- $title -}}
                        {{ if .url }}
                        </a>
                        {{ end -}}
                      </h3>
                    </div>
                  {{ end -}}
                  <div class="media">
                    {{- if .logo -}}
                      {{- partial "commons/image.html"
                            (dict
                              "image"    .logo
                              "alt"      $title
                              "sizes"    site.Params.image_sizes.blocks.partners
                            ) -}}
                    {{- end -}}
                  </div>
                </article>
              {{ end -}}

            </div>
          {{ end -}}
        </div>
      </div>
    </div>
  </section>
{{- end -}}
